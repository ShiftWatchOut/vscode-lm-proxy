# 実装TODO リスト

## 1. プロジェクトセットアップ
- [x] プロジェクトの初期化
- [x] 必要なパッケージのインストール
  - [x] Express.js
  - [x] TypeScript関連パッケージ
- [x] VSCode拡張機能の基本設定
- [x] ファイル構造の作成

## 2. コマンドパレット機能の実装
- [x] コマンド定義の作成
  - [x] `vscode-lm-proxy.startServer`
  - [x] `vscode-lm-proxy.stopServer`
  - [x] `vscode-lm-proxy.selectModel`
- [x] サーバー関連コマンドハンドラーの実装
- [x] モデル選択コマンドハンドラーの実装
- [x] キーバインディングの設定
- [ ] コマンドのパッケージ化

## 3. サーバー機能の実装
- [x] HTTPサーバーの基本実装
  - [x] サーバーマネージャーの作成
  - [x] Express.jsサーバーのセットアップ
  - [x] ポート4000での待ち受け
- [x] `/chat/completions` エンドポイントの実装
  - [x] リクエストの受付
  - [x] リクエストのバリデーション
  - [x] OpenAI API形式のレスポンス

## 4. VSCode Language Model API連携
- [x] モデル選択機能の実装
  - [x] `vscode.lm.selectChatModels()`を使用したモデル取得
  - [x] モデルファミリー対応（gpt-4o, gpt-4o-mini, o1, o1-mini, claude-3.5-sonnet）
  - [x] クイックピックUIの実装
  - [x] モデル選択状態の管理
- [x] VSCode LM APIとの連携
  - [x] `LanguageModelChatMessage`クラスを使用したメッセージ変換
  - [x] リクエストの変換（OpenAI形式→LM API形式）
  - [x] レスポンスの変換（LM API形式→OpenAI形式）
  - [x] ストリーミングレスポンス対応
- [x] エラーハンドリングと制限管理
  - [x] モデル選択時のエラー処理
  - [x] `LanguageModelError`の適切な処理
  - [x] トークン制限管理（モデルごとの上限対応）
  - [x] レート制限対応とスロットリング

## 5. ステータスバー機能
- [x] ステータスバーアイテムの作成
- [x] サーバー状態の表示
  - [x] 起動中の表示
  - [x] 停止中の表示
  - [x] エラー状態の表示
- [x] クリックアクションの実装
  - [x] コマンドメニューの表示
  - [x] クイックアクション機能
- [x] statusBarManagerの実装

## 6. エラーハンドリング
- [x] サーバーエラーのハンドリング
- [x] API呼び出しエラーのハンドリング
- [x] モデル選択エラーのハンドリング
- [x] エラー通知の実装
- [x] コマンド実行エラーの処理

## 7. テストと検証
- [ ] 単体テストの作成
  - [ ] コマンド機能のテスト
  - [ ] サーバー機能のテスト
  - [ ] モデル管理のテスト
  - [ ] LM API変換ロジックのテスト
- [ ] 統合テストの作成
  - [ ] エンドツーエンドのリクエスト・レスポンスフロー
  - [ ] ストリーミングレスポンスの検証
- [ ] 外部クライアントからのアクセステスト
  - [ ] curl/Postmanを使ったテスト
  - [ ] OpenAIクライアントライブラリ互換性テスト
- [ ] エラーケースのテスト
  - [ ] モデル非対応時のフォールバック
  - [ ] レート制限時の挙動
  - [ ] トークン上限超過時の挙動
- [ ] コマンドパレット操作のテスト

## 8. ドキュメント作成
- [x] README.mdの作成
  - [x] インストール手順
  - [x] 使用方法
  - [x] コマンド一覧
  - [x] サポートモデルと制限事項
- [x] API仕様書の作成
  - [x] エンドポイント詳細
  - [x] リクエスト/レスポンス形式
  - [x] OpenAI API互換性の範囲と制限
- [x] コマンドリファレンスの作成
- [x] トラブルシューティングガイド
  - [x] 一般的なエラーと解決方法
  - [x] モデル選択問題の解決
  - [x] サーバー接続問題の解決
- [x] セキュリティと制限に関するガイド
  - [x] 認証と同意の説明
  - [x] トークンとレート制限の説明

## 9. パッケージング
- [x] 拡張機能のパッケージング設定
- [x] アイコンとバナーの作成
- [x] マニフェストファイルの更新
  - [x] コマンド定義の追加
  - [x] キーバインディングの設定
  - [x] アクティベーションイベントの設定
- [ ] Marketplaceへの公開準備
  - [ ] Microsoft AI tools and practices guidelinesへの準拠確認
  - [ ] GitHub Copilot extensibility acceptable development policyの確認
  - [ ] 依存関係の最適化（GitHub Copilot依存を導入しない考慮）